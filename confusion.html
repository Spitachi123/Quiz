<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Confusion & Quiz Display</title>
<style>
body {
    font-family: "Lobster", cursive;
    text-align: center;
    padding: 50px;
    background: linear-gradient(135deg, #0f0f0f, #3b3a3b, #010102);
    background-size: 400% 400%;
    animation: gradientBG 15s ease infinite;
    color: white;
}
@keyframes gradientBG {
    0% {background-position: 0% 50%;}
    50% {background-position: 100% 50%;}
    100% {background-position: 0% 50%;}
}

h2 {
    margin-bottom: 30px;
    font-size: 2.2em;
    text-shadow: 2px 2px 8px #000;
}

ul {
    text-align: left;
    display: inline-block;
    margin-top: 20px;
    background: rgba(255,255,255,0.1);
    padding: 15px;
    border-radius: 10px;
}
li {
    margin: 8px 0;
    font-size: 18px;
}

button {
    padding: 10px 20px;
    margin: 10px;
    cursor: pointer;
    border: none;
    border-radius: 6px;
    background: #00aaff;
    color: white;
    font-size: 16px;
    transition: 0.3s;
}
button:hover {
    background: #ffaa00;
    transform: scale(1.05);
}

#quiz {
    margin-top: 30px;
    text-align: left;
    display: inline-block;
    width: 80%;
}

.quiz-card {
    background: rgba(255,255,255,0.1);
    border: 2px solid #00aaff;
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 0 15px rgba(0,170,255,0.6);
    transition: 0.3s;
}
.quiz-card:hover {
    transform: scale(1.02);
    box-shadow: 0 0 25px rgba(255,170,0,0.8);
}

.quiz-card p {
    font-size: 20px;
    margin-bottom: 10px;
}

label {
    display: block;
    margin: 5px 0;
    cursor: pointer;
}

.correct {
    color: lightgreen;
    font-weight: bold;
}
.wrong {
    color: #ff4444;
    font-weight: bold;
}

/* Celebration canvas */
#celebrationCanvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    z-index: 999;
}
</style>
</head>
<body>

<h2>Students Confused</h2>
<ul id="confusionEntries"></ul>
<button onclick="clearConfusions()">Clear All</button>
<a href="member.html"><button>Back</button></a>
<button onclick="showQuiz()">Show Quiz</button>
<button onclick="toggleCelebrationMenu()">üéâ Thank You</button>

<div id="quiz"></div>

<!-- Celebration Options -->
<div id="celebrationMenu" style="display:none; margin-top:20px;">
    <button onclick="launchExternalConfetti()">üéä Imported Confetti</button>
    <h1>Thank You!</h1>
</div>

<canvas id="celebrationCanvas"></canvas>

<!-- External Libraries -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<script src="https://unpkg.com/lottie-web"></script>

<script>
function loadConfusions(){
    const saved = JSON.parse(sessionStorage.getItem('confusions')) || [];
    const ul = document.getElementById('confusionEntries');
    ul.innerHTML='';
    saved.forEach(entry => {
        const li = document.createElement('li');
        li.textContent = `${entry.name} is confused in ${entry.topic}`;
        ul.appendChild(li);
    });
}

function clearConfusions(){
    sessionStorage.removeItem('confusions');
    loadConfusions();
    document.getElementById('quiz').innerHTML = '';
}

const quizQuestions = [
    // ‚úÖ Your original 4 questions
    { topic: "Vector", question: "What does the parallelogram law of vector addition state?", options: { A:"The sum of two vectors is represented by the diagonal of a parallelogram formed on them.", B:"The sum of two vectors is represented by the area of the parallelogram formed on them.", C:"The sum of two vectors is represented by the difference of their magnitudes.", D:"The sum of two vectors is represented by the triangle formed by them." }, answer: "A" },
    { topic: "Vector", question: "What does the commutative property of vector addition state?", options: { A:"The sum of vector A and vector B is equal to vector B minus vector A.", B:"The sum of vector A and vector B is equal to the sum of vector B and vector A.", C:"The sum of vector A and vector B is equal to vector A only.", D:"The sum of vector A and vector B is equal to vector B only." }, answer: "B" },
    { topic: "Vector", question: "What is a zero vector?", options: { A:"A vector with magnitude 1 and direction along an axis", B:"A vector with magnitude 0 and no direction", C:"A vector written in a vertical column", D:"A vector pointing opposite to another vector" }, answer: "B" },
    { topic: "Vector", question: "What is a negative vector?", options: { A:"A vector with magnitude 0 and no direction", B:"A vector with magnitude 1 and direction along axes", C:"A vector with the same magnitude as another but pointing in the opposite direction", D:"A vector that moves only along the x-axis" }, answer: "C" },

    // ‚úÖ 6 new questions from our discussion
    { topic: "Equal Vectors", question: "When are two vectors called equal?", options: { A:"Same magnitude and same direction", B:"Same magnitude but different direction", C:"Different magnitude but same direction", D:"Different magnitude and direction" }, answer: "A" },
    { topic: "Unequal Vectors", question: "Which of these is an unequal vector pair?", options: { A:"Same magnitude and same direction", B:"Same magnitude but different direction", C:"Same direction and same length", D:"Both equal in all aspects" }, answer: "B" },
    { topic: "Parallel Vectors", question: "If A = k¬∑B and k < 0, what does it mean?", options: { A:"Same direction", B:"Opposite direction", C:"Equal vectors", D:"Zero vector" }, answer: "B" },
    { topic: "Like Vectors", question: "Like vectors are defined as:", options: { A:"Same direction, any magnitude", B:"Opposite direction, same magnitude", C:"Different directions", D:"Zero magnitude" }, answer: "A" },
    { topic: "Unlike Vectors", question: "Unlike vectors have:", options: { A:"Same direction", B:"Angle 0¬∞ or 180¬∞", C:"Different directions (angle ‚â† 0¬∞ or 180¬∞)", D:"No direction" }, answer: "C" },
    { topic: "Coinitial Vectors", question: "Coinitial vectors share:", options: { A:"Same magnitude", B:"Same starting point (tail)", C:"Same direction only", D:"Same endpoint" }, answer: "B" }
];


/* Display Quiz */
function showQuiz(){
    const qDiv = document.getElementById('quiz');
    qDiv.innerHTML = "<h3>‚ú® Quiz Time ‚ú®</h3>";

    quizQuestions.forEach((q, idx) => {
        const section = document.createElement('div');
        section.className = "quiz-card";
        section.innerHTML = `<p><b>${idx+1}. ${q.question}</b> <i>(${q.topic})</i></p>` +
            Object.keys(q.options).map(opt => 
                `<label><input type="radio" name="q${idx}" value="${opt}"> ${opt}: ${q.options[opt]}</label>`
            ).join('') +
            `<button onclick="checkAnswer(${idx}, '${q.answer}')">Submit</button>
             <p id="result${idx}"></p>`;
        qDiv.appendChild(section);
    });
}

/* Check Answer */
function checkAnswer(idx, correct){
    const selected = document.querySelector(`input[name="q${idx}"]:checked`);
    const result = document.getElementById(`result${idx}`);
    if(!selected){ result.textContent="‚ö†Ô∏è Please select an option."; return; }
    if(selected.value === correct){
        result.textContent="‚úÖ Correct!";
        result.className="correct";
        launchExternalConfetti();
    } else {
        result.textContent="‚ùå Wrong. Correct answer is " + correct;
        result.className="wrong";
    }
}

/* Celebration Effects */
function toggleCelebrationMenu(){
    const menu = document.getElementById('celebrationMenu');
    menu.style.display = (menu.style.display === "none") ? "block" : "none";
}

const canvas = document.getElementById('celebrationCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

function launchConfetti(){
    let particles = [];
    for(let i=0;i<150;i++){
        particles.push({
            x: Math.random()*canvas.width,
            y: Math.random()*canvas.height - canvas.height,
            color: `hsl(${Math.random()*360},100%,50%)`,
            size: Math.random()*6+2,
            speed: Math.random()*3+2
        });
    }
    animateParticles(particles, "confetti");
}

function launchClaps(){
    let particles = [];
    for(let i=0;i<50;i++){
        particles.push({
            x: canvas.width/2,
            y: canvas.height/2,
            text: "üëè",
            size: 24,
            dx: (Math.random()-0.5)*6,
            dy: (Math.random()-0.5)*6
        });
    }
    animateParticles(particles, "claps");
}

function launchBubbles(){
    let particles = [];
    for(let i=0;i<80;i++){
        particles.push({
            x: Math.random()*canvas.width,
            y: canvas.height+Math.random()*100,
            radius: Math.random()*20+10,
            dy: Math.random()*2+1,
            color: "rgba(173,216,230,0.6)"
        });
    }
    animateParticles(particles, "bubbles");
}

function animateParticles(particles, type){
    let frame=0;
    function animate(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        particles.forEach(p=>{
            if(type==="confetti"){
                p.y+=p.speed;
                ctx.fillStyle=p.color;
                ctx.fillRect(p.x,p.y,p.size,p.size);
            }
            if(type==="claps"){
                p.x+=p.dx;
                p.y+=p.dy;
                ctx.font=p.size+"px Arial";
                ctx.fillText(p.text,p.x,p.y);
            }
            if(type==="bubbles"){
                p.y-=p.dy;
                ctx.beginPath();
                ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
                ctx.fillStyle=p.color;
                ctx.fill();
            }
        });
        frame++;
        if(frame<200){ requestAnimationFrame(animate); }
        else { ctx.clearRect(0,0,canvas.width,canvas.height); }
    }
    animate();
}

/* ‚úÖ Imported Celebration Effects */
function launchExternalConfetti(){
    confetti({
        particleCount: 200,
        spread: 120,
        origin: { y: 0.6 }
    });
}

function launchLottieFireworks(){
    const container = document.createElement('div');
    container.style.position = 'fixed';
    container.style.top = '0';
    container.style.left = '0';
    container.style.width = '100%';
    container.style.height = '100%';
    container.style.zIndex = '1000';
    document.body.appendChild(container);

    const anim = lottie.loadAnimation({
        container: container,
        renderer: 'svg',
        loop: false,
        autoplay: true,
        path: 'https://assets9.lottiefiles.com/packages/lf20_jcikwtux.json' // Fireworks JSON
    });

    anim.addEventListener('complete', () => {
        document.body.removeChild(container);
    });
}

/* ‚úÖ Load confusions on page load */
window.onload = loadConfusions;

/* ‚úÖ Resize canvas dynamically */
window.onresize = function(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
};

/* ‚úÖ Clear canvas when unloading page */
window.onunload = function(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
};
</script>
</body>
</html>
